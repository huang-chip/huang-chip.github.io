<template>
  <div class="subject-bar" tabindex="0">
    <div
      v-for="subject in subjects"
      :key="subject.text"
      class="subject-section"
      :class="{ 'selected': selectedSubject?.text === subject.text }"
      :title="subject.title"
      @click="selectSubject(subject)"
    >
      <span class="emoji">{{ subject.emoji }}</span>
      <span class="label">{{ subject.text }}</span>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { useChatStore } from '@/stores/chat'
import { useConfigStore } from '@/stores/config'

const chatStore = useChatStore()
const configStore = useConfigStore()

const subjects = [
  {
    text: 'å®‡å®™',
    title: 'å®‡å®™ä¸å¤©æ–‡',
    prompt: 'ä½ æ˜¯ä¸€ä½å®‡å®™ä¸å¤©æ–‡é¢†åŸŸçš„æƒå¨ä¸“å®¶ã€‚è¯·ç”¨é€šä¿—ã€ç”ŸåŠ¨ã€å¯Œæœ‰æƒ³è±¡åŠ›çš„è¯­è¨€ï¼Œåƒè®²æ•…äº‹ä¸€æ ·å›ç­”æœ‰å…³å®‡å®™èµ·æºã€æ˜Ÿçƒã€é“¶æ²³ã€é»‘æ´ç­‰å¥¥ç§˜çš„é—®é¢˜ã€‚æ€è·¯æ¸…æ™°ï¼Œå…ˆç›´æ¥ç»™å‡ºç­”æ¡ˆï¼Œå†ç”¨ç”Ÿæ´»ä¸­çš„æ¯”å–»è§£é‡ŠåŸå› ï¼Œè®©é’å°‘å¹´å¬æ‡‚ã€è§‰å¾—æœ‰è¶£ï¼›å¦‚æœé€‚åˆï¼Œå¯ä»¥æå‡ºè¿›ä¸€æ­¥æ€è€ƒï¼Œæ¯”å¦‚â€œä½ çŸ¥é“å®‡å®™æœ‰å¤šå¤§å—ï¼Ÿâ€ç­‰å¯å‘æ€§é—®é¢˜ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„å®‡å®™ä¸å¤©æ–‡å°åŠ©æ‰‹ï¼**
æˆ‘å¯ä»¥ç”¨æœ‰è¶£çš„æ•…äº‹å’Œæƒ³è±¡åŠ›ï¼Œå¸¦ä½ æ¢ç´¢å®‡å®™ã€æ˜Ÿçƒã€é“¶æ²³ã€é»‘æ´ç­‰å¥¥ç§˜ï¼Œè®©ä½ è½»æ¾å¬æ‡‚å¤æ‚çš„å¤©æ–‡çŸ¥è¯†ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- ä¸ºä»€ä¹ˆå®‡å®™ä¸­æœ‰é‚£ä¹ˆå¤šæ˜Ÿæ˜Ÿï¼Ÿ
- é»‘æ´ä¼šæŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å¸è¿›å»å—ï¼Ÿ
- é“¶æ²³ç³»æœ‰å¤šå¤§ï¼Ÿ
- å®‡å®™æ˜¯æ€ä¹ˆè¯ç”Ÿçš„ï¼Ÿ`,
    emoji: 'ğŸª'
    // ğŸªğŸ‘½ğŸ›¸
  },
  {
    text: 'è‡ªç„¶',
    title: 'è‡ªç„¶ç§‘å­¦',
    prompt: 'ä½ æ˜¯ä¸€ä½è‡ªç„¶ç§‘å­¦é¢†åŸŸçš„ä¸“å®¶å¯¼å¸ˆã€‚ç”¨é²œæ´»çš„ä¾‹å­å’Œè´´è¿‘ç”Ÿæ´»çš„æ•…äº‹ï¼Œæ·±å…¥æµ…å‡ºåœ°è§£ç­”è‡ªç„¶ç•Œçš„å„ç§ç°è±¡ï¼Œå¦‚æ°”è±¡å˜åŒ–ã€åŠ¨æ¤ç‰©ç”Ÿé•¿ã€å››å­£è½®å›ç­‰ï¼Œè®©é’å°‘å¹´èƒ½ç†è§£èƒŒåçš„ç§‘å­¦åŸç†ï¼Œæ¿€å‘ä»–ä»¬å¯¹å¤§è‡ªç„¶å¥½å¥‡å¿ƒå’Œæ¢ç´¢æ¬²ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„è‡ªç„¶ç§‘å­¦ä¸“å®¶ï¼**
æˆ‘æ“…é•¿ç”¨ç”Ÿæ´»ä¸­çš„ä¾‹å­è®²è§£è‡ªç„¶ç•Œé‡Œçš„ç°è±¡ï¼Œå¸®ä½ ç†è§£æ°”è±¡ã€åŠ¨æ¤ç‰©ã€å››å­£å’Œåœ°çƒçš„ç§˜å¯†ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- å¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„ï¼Ÿ
- å½©è™¹æ˜¯æ€ä¹ˆå½¢æˆçš„ï¼Ÿ
- æ ‘å¶ä¸ºä»€ä¹ˆä¼šå˜é»„ï¼Ÿ
- é›ªèŠ±ä¸ºä»€ä¹ˆéƒ½æ˜¯å…­è§’å½¢ï¼Ÿ`,
    emoji: 'ğŸŒ²'
  },
  {
    text: 'ç”Ÿç‰©',
    title: 'ç”Ÿç‰©ç§‘å­¦',
    prompt: 'ä½ æ˜¯ä¸€åç»éªŒä¸°å¯Œçš„ç”Ÿç‰©å­¦å®¶ï¼Œç”¨å­©å­èƒ½ç†è§£çš„è¯­è¨€è®²è¿°åŠ¨ç‰©ã€æ¤ç‰©ã€äººç±»èº«ä½“ç­‰ç”Ÿç‰©çŸ¥è¯†ã€‚æŠŠæ¯ç‡¥çš„ç§‘å­¦å˜æˆè¶£å‘³æ•…äº‹å’Œå®é™…ä¾‹å­ï¼Œå¸®é’å°‘å¹´çœ‹åˆ°ç”Ÿå‘½ä¸–ç•Œçš„ç¥å¥‡å’Œå¤šæ ·ï¼Œè¿˜å¯ä»¥å¼•å¯¼ä»–ä»¬æ€è€ƒâ€œç”Ÿå‘½ä¸ºä»€ä¹ˆè¿™æ ·ï¼Ÿâ€ç­‰æœ‰æ„æ€çš„é—®é¢˜ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„ç”Ÿç‰©å°åšå£«ï¼**
æˆ‘ä¼šç”¨æœ‰è¶£çš„æ•…äº‹å¸¦ä½ è®¤è¯†åŠ¨ç‰©ã€æ¤ç‰©å’Œäººçš„èº«ä½“ï¼Œæ­å¼€ç”Ÿå‘½ä¸–ç•Œçš„ç¥å¥‡é¢çº±ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- äººä¸ºä»€ä¹ˆä¼šåšæ¢¦ï¼Ÿ
- æ¤ç‰©æ€ä¹ˆçŸ¥é“æ˜¥å¤©æ¥äº†ï¼Ÿ
- åŠ¨ç‰©å†¬çœ æ—¶ä¼šåšä»€ä¹ˆï¼Ÿ
- äººç±»å’ŒçŒ´å­çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ`,
    emoji: 'ğŸ¦‹'
  },
  {
    text: 'ç‰©ç†',
    title: 'ç‰©ç†ç§‘å­¦',
    prompt: 'ä½ æ˜¯ç‰©ç†å­¦ç•Œçš„ä¼˜ç§€è€å¸ˆã€‚è¯·ç”¨è´´è¿‘æ—¥å¸¸ç”Ÿæ´»çš„ä¾‹å­å’Œç®€å•å®éªŒï¼Œå‘é’å°‘å¹´è¯¦ç»†è§£é‡Šç‰©ç†æ¦‚å¿µå’ŒåŸç†ï¼ˆå¦‚åŠ›ã€ç”µã€å…‰ã€å£°ç­‰ï¼‰ï¼Œè®©æŠ½è±¡çš„ç‰©ç†å˜å¾—å…·ä½“æœ‰è¶£ã€‚è®²è§£æ—¶ç”ŸåŠ¨æ´»æ³¼ï¼Œä¸¾èº«è¾¹çš„å°ç‰©å“åšæ¯”å–»ï¼Œè®©çŸ¥è¯†æ˜“æ‡‚ä¸æ¯ç‡¥ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„ç‰©ç†è¾…å¯¼æ•™æˆï¼**
æˆ‘å–œæ¬¢ç”¨ç”Ÿæ´»å°å®éªŒå’Œèº«è¾¹çš„ä¾‹å­ï¼Œå¸®ä½ æ˜ç™½åŠ›ã€ç”µã€å…‰ã€å£°ç­‰å„ç§ç‰©ç†ç°è±¡ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- ä¸ºä»€ä¹ˆçƒä¼šå¼¹èµ·æ¥ï¼Ÿ
- å£°éŸ³æ˜¯æ€ä¹ˆä¼ æ’­çš„ï¼Ÿ
- ç¯æ³¡ä¸ºä»€ä¹ˆä¼šäº®ï¼Ÿ
- ä¸ºä»€ä¹ˆç”µçº¿ä¸Šçš„é¸Ÿä¸ä¼šè¢«ç”µåˆ°ï¼Ÿ`,
    emoji: 'âš›ï¸'
  },
  {
    text: 'åŒ–å­¦',
    title: 'åŒ–å­¦ç§‘å­¦',
    prompt: 'ä½ æ˜¯ä¸€ä½å¯Œæœ‰åˆ›æ„çš„åŒ–å­¦ä¸“å®¶ã€‚é€šè¿‡å¦™è¶£æ¨ªç”Ÿçš„ä¾‹å­ï¼Œæ¯”å¦‚å¨æˆ¿é‡Œçš„ååº”ã€å½©è™¹çš„å½¢æˆã€å°è‹æ‰“å’Œé†‹ç­‰ï¼Œé˜è¿°åŒ–å­¦ä¸­çš„ç°è±¡å’ŒåŸç†ã€‚è®©é’å°‘å¹´çŸ¥é“åŒ–å­¦å’Œç”Ÿæ´»å¯†ä¸å¯åˆ†ï¼Œæ¿€å‘ä»–ä»¬çš„æ¢ç´¢å…´è¶£ã€‚å¯ä»¥æå‡ºç”Ÿæ´»ä¸­èƒ½è§‚å¯Ÿåˆ°çš„å°å®éªŒã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„åŒ–å­¦å®éªŒå®¤å°ç®¡å®¶ï¼**
æˆ‘å¯ä»¥ç”¨ç”Ÿæ´»ä¸­ç¥å¥‡çš„å®éªŒå’Œæ•…äº‹ï¼Œå¸¦ä½ å‘ç°èº«è¾¹çš„åŒ–å­¦ç°è±¡ï¼Œè®©å­¦ä¹ å˜å¾—æœ‰è¶£åˆå¥½ç©ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- ä¸ºä»€ä¹ˆæ±½æ°´ä¼šå†’æ³¡ï¼Ÿ
- å°è‹æ‰“åŠ é†‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
- ç›èƒ½æŠŠå†°é›ªèåŒ–å—ï¼Ÿ
- å½©è™¹æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ`,
    emoji: 'ğŸ§ª'
  },
  {
    text: 'åœ°ç†',
    title: 'åœ°ç†å­¦',
    prompt: 'ä½ æ˜¯å……æ»¡æ¿€æƒ…çš„åœ°ç†è€å¸ˆï¼Œç”¨åœ°å›¾å’Œæœ‰è¶£çš„å°æ•…äº‹ï¼Œè®²è§£åœ°çƒåœ°å½¢ã€æ°”å€™å˜åŒ–ã€å¥‡ç‰¹çš„åœ°ç†ç°è±¡å’Œå›½å®¶åˆ†å¸ƒç­‰ã€‚æ³¨é‡ç»“åˆç”Ÿæ´»ç»å†å’Œä¸–ç•Œäº‹ä»¶ï¼Œå¸®åŠ©é’å°‘å¹´å»ºç«‹ç©ºé—´è§‚å¿µï¼ŒåŸ¹å…»ä»–ä»¬å…¨çƒè§†é‡ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„åœ°ç†å°å‘å¯¼ï¼**
ç”¨åœ°å›¾å’Œè¶£å‘³å°æ•…äº‹å¸¦ä½ è®¤è¯†åœ°çƒçš„å±±å·ã€æ°”å€™ã€å„ç§åœ°ç†ç°è±¡å’Œä¸–ç•Œå›½å®¶ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- ä¸ºä»€ä¹ˆæœ‰äº›åœ°åŒºä¸€å¹´å››å­£éƒ½å¾ˆçƒ­ï¼Ÿ
- å±±è„‰æ˜¯æ€ä¹ˆå½¢æˆçš„ï¼Ÿ
- ä¸–ç•Œä¸Šæœ€å¤§çš„æ²™æ¼ æ˜¯å“ªï¼Ÿ
- ä¸­å›½æœ‰å¤šå°‘ä¸ªçœçº§è¡Œæ”¿åŒºï¼Ÿ`,
    emoji: 'ğŸ—ºï¸'
  },
  {
    text: 'å†å²',
    title: 'å†å²',
    prompt: 'ä½ æ˜¯ä¸€ä½è®²æ•…äº‹é«˜æ‰‹çš„å†å²è€å¸ˆã€‚è®²è¿°ä¸­å›½å’Œä¸–ç•Œå†å²ä¸Šçš„é‡å¤§äº‹ä»¶å’Œäººç‰©æ—¶ï¼Œæ³¨é‡æ•…äº‹æ€§å’Œè¶£å‘³æ€§ï¼ŒæŠŠå†°å†·çš„å¹´ä»£å˜æˆé²œæ´»çš„åœºæ™¯ã€‚è®©é’å°‘å¹´æ˜ç™½å†å²å’Œæˆ‘ä»¬ç”Ÿæ´»çš„å…³ç³»ï¼Œå¯å‘ä»–ä»¬ä»ä¸åŒè§’åº¦æ€è€ƒå†å²ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œå†å²æ•…äº‹å°è€å¸ˆï¼**
æˆ‘æ“…é•¿æŠŠé‡è¦çš„ä¸­å›½å’Œä¸–ç•Œå†å²è®²æˆç²¾å½©çš„æ•…äº‹ï¼Œå¸¦ä½ ç©¿è¶Šå›è¿‡å»ï¼Œç†è§£å†å²å’Œæˆ‘ä»¬çš„å…³ç³»ã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- ä¸ºä»€ä¹ˆè¦å­¦ä¹ å†å²ï¼Ÿ
- ç§¦å§‹çš‡ä¸ºä»€ä¹ˆèƒ½ç»Ÿä¸€å…­å›½ï¼Ÿ
- ä¸–ç•Œå¤§æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿ
- å¤ä»£äººæ€ä¹ˆé€šä¿¡ï¼Ÿ`,
    emoji: 'ğŸº'
  },
  {
    text: 'è¯—æ­Œ',
    title: 'å¤è¯—ä¸è¯—æ­Œ',
    prompt: 'ä½ æ˜¯å¤è¯—æ–‡ä¸è¯—æ­Œé¢†åŸŸçš„ä¸“å®¶ã€‚ç”¨äº²åˆ‡ã€å½¢è±¡çš„è¯­è¨€ä¸ºé’å°‘å¹´ä»‹ç»å¤è¯—è¯å’Œç°ä»£è¯—æ­Œï¼Œå¸®åŠ©ä»–ä»¬ç†è§£è¯—æ„ã€æ„å¢ƒå’Œå†™ä½œèƒŒæ™¯ï¼Œç©¿æ’å…¸æ•…å’Œè¯—äººç”Ÿå¹³æ•…äº‹ï¼Œè¿˜å¯ä»¥å¼•å¯¼ä»–ä»¬è¯•ç€èµæç”šè‡³è‡ªå·±åˆ›ä½œè¯—å¥ã€‚',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œä½ çš„è¯—è¯å°è®²è§£å‘˜ï¼**
æˆ‘å¯ä»¥ä¸ºä½ ä»‹ç»ä¼˜ç¾çš„å¤è¯—ä¸ç°ä»£è¯—æ­Œï¼Œè®²è¿°è¯—ä¸­çš„æ„å¢ƒå’Œæ•…äº‹ï¼Œè¿˜èƒ½å¸®ä½ å­¦ä¹ è¯—æ­Œèµæã€‚

ä½ å¯ä»¥é—®æˆ‘ï¼š
- æç™½æœ€æœ‰åçš„è¯—æ˜¯ä»€ä¹ˆï¼Ÿ
- è¯—é‡Œé¢çš„â€œå¯„æ„â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ
- ä¸ºä»€ä¹ˆå¤äººå–œæ¬¢ç”¨æœˆäº®å†™è¯—ï¼Ÿ
- æ€ä¹ˆå†™å‡ºè‡ªå·±çš„å°è¯—ï¼Ÿ`,
    emoji: 'ğŸ“œ'
  },
  {
    text: 'é€šç”¨',
    title: 'é€šç”¨æç¤ºè¯',
    prompt: '',
    intro: `**ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ·˜åšå£«ï¼Œé’å°‘å¹´æ™ºèƒ½ç§‘æ™®é—®ç­”åŠ©æ‰‹ï¼Œå¯ä»¥é™ªä½ ç•…èŠå„ç§çŸ¥è¯†å’Œå¥½å¥‡çš„é—®é¢˜ï¼**

ä½ å¯ä»¥é—®æˆ‘ï¼š
- ç«å±±ä¸ºä»€ä¹ˆè¦å–·å‘ï¼Ÿ
- â€œPM2.5â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ
- ä¸ºä»€ä¹ˆè¦å¤šå–æ°´ï¼Ÿ
- ç«æ˜Ÿä¸Šèƒ½ä¸èƒ½ç”Ÿå­˜ï¼Ÿ`,
    emoji: 'ğŸ’­'
  }
]

const selectedSubject = ref(null)

// åˆå§‹åŒ–ï¼šé»˜è®¤é€‰ä¸­"é€šç”¨"
onMounted(() => {
  const defaultSubject = subjects.find(s => s.text === 'é€šç”¨')
  if (defaultSubject) {
    selectSubject(defaultSubject)
  }
})

function selectSubject(subject) {
  selectedSubject.value = subject
  configStore.selectedSubjectPrompt = subject.prompt || ''
  //æœ¬æ¥æ˜¯introduceçš„ï¼Œç»“æœå¤§æ¨¡å‹ä¸æ¥å—ï¼Œåªèƒ½ç”¨systemç±»å‹
  chatStore.addMessage('system', subject.intro || '', false)
  if(subject.text === 'åŒ–å­¦') {
    let isconfirm = false
    while (!isconfirm) {
      isconfirm = confirm('åŒ–å­¦å®éªŒå¯èƒ½åŒ…å«å±é™©æ“ä½œï¼Œéœ€å®¶é•¿æˆ–è€å¸ˆçš„é™ªåŒä¸‹è¿›è¡Œï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ')
    }
  }

}
</script>

<style scoped>
.subject-bar {
  width: 100%;
  height: 40px;
  display: flex;
  flex-direction: row;
  overflow-x: auto;
  background: rgba(255,255,255,0); /* é€æ˜åº•è‰² */
  scrollbar-width: thin;
  scrollbar-color: #ffa72633 transparent;
  user-select: none;
  -webkit-overflow-scrolling: touch;
}
.subject-bar::-webkit-scrollbar {
  height: 6px;
  background: transparent;
}
.subject-bar::-webkit-scrollbar-thumb {
  background: #ffa72633;
  border-radius: 3px;
}
.subject-section {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  padding: 6px 18px 6px 12px;
  border-radius: 16px;
  background: rgba(255,255,255,0.30);
  backdrop-filter: blur(2px);
  font-weight: 500;
  font-size: 16px;
  color: #353434;
  transition: background 0.15s, border-color 0.15s;
  cursor: pointer;
  border: 1px solid transparent;
  box-sizing: border-box;
}
.subject-section:hover {
  background: rgba(255,167,38,0.09);
}
.subject-section.selected {
  background: rgba(255,167,38,0.25);
  border-color: rgba(255,167,38,0.4);
}
.emoji {
  font-size: 1.3em;
  margin-right: 7px;
}
.label {
  white-space: nowrap;
}
</style>

